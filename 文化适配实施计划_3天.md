# 文化适配实施计划

**制定日期：** 2025年12月15日  
**执行周期：** 3个工作日  
**负责人：** 王田宇  
**目标：** 完成北美市场文化适配知识库第一版，支持个性化五行建议输出

---

## 一、核心问题诊断

### 1.1 现状问题
- ❌ **覆盖过泛**：5万条数据涵盖所有生活领域（职业、健康、金钱等），缺乏聚焦
- ❌ **维度缺失**：未细化种族、宗教信仰、区域等关键社会属性
- ❌ **推断缺失**：无法根据出生地（如密西西比州）推断文化特性（如天主教文化）
- ❌ **风险隐患**：可能输出宗教字眼（"基督教""耶稣"），导致上架审核失败

### 1.2 目标定义
构建**精准的北美文化适配知识库**，实现：
1. ✅ 覆盖核心社会属性：性别、年龄、区域、种族、宗教信仰
2. ✅ 基于出生地自动推断文化特性（如纽约州 → 多元文化，密西西比州 → 保守天主教）
3. ✅ 宗教内容隐性处理（提取文化特性如素食习惯，不出现宗教字眼）
4. ✅ 聚焦选择困难症人群（高频决策场景：穿搭、饮食、社交）

---

## 二、核心实施方案

###  整体思路：外围文化适配层

**关键原则：保持现有知识库不变，通过"提示词工程"实现文化适配**

```
┌─────────────────────────────────────────────────────────────┐
│                   用户输入层                                 │
│  新增字段：出生州、年龄段、性别                             │
│  （前端增加选择框，不强制填写）                             │
└─────────────────────┬───────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────┐
│           地理-文化映射表（新建静态数据文件）                │
│  内容：50个州 → 文化特性描述（不含宗教字眼）                │
│  示例：                                                      │
│  - 密西西比州 → "重视家庭聚会、传统饮食偏好、社区导向"      │
│  - 纽约州 → "快节奏生活、多元文化、注重个人效率"            │
│  - 加州 → "健康意识强、植物性饮食倾向、创新开放"            │
└─────────────────────┬───────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────┐
│         提示词动态拼接（核心改动点）                         │
│  原有内容保持不变：                                          │
│  - 系统角色（五行顾问）                                     │
│  - L4知识库匹配内容                                         │
│  - 用户八字排盘结果                                         │
│  - 对话历史                                                  │
│                                                              │
│  新增文化适配段落（插入到提示词末尾）：                     │
│  "This user is from [州名], where people typically value    │
│   [文化特性]. Adjust your advice to fit their lifestyle     │
│   without mentioning any religious terms."                   │
└─────────────────────┬───────────────────────────────────────┘
                      │
                      ▼
┌─────────────────────────────────────────────────────────────┐
│              大模型自动文化适配                              │
│  L1-L4知识库不变 → 大模型根据文化提示调整输出               │
│  示例：                                                      │
│  - 保守州用户 → "Wear beige for family gatherings"         │
│  - 自由派州用户 → "Try bold colors for self-expression"    │
└─────────────────────────────────────────────────────────────┘
```



---

## 三、3天执行计划

### Day 1：文化特性调研与映射表构建（2025-12-16）

#### 上午（9:00-12:00）
**任务 1.1：调研北美50个州的文化特性（使用AI工具）**

**工具：** ChatGPT / Claude / Perplexity

**调研维度（5个核心因子）：**
1. **家庭观念强度**（高/中/低）
   - 示例：南部州家庭聚会频繁，东北部更注重个人独立
2. **饮食文化偏好**
   - 示例：中西部肉食为主，西海岸植物性饮食流行
3. **社交风格**
   - 示例：南部热情外向，东北部直接高效
4. **生活节奏**
   - 示例：纽约快节奏，蒙大拿慢生活
5. **决策风格**
   - 示例：保守州重视社区认同，自由派州强调个人选择

**提问模板（向AI提问）：**
```
请分析美国以下州的居民生活方式特点，要求：
1. 不要提及任何宗教名称（如天主教、基督教）
2. 用行为特征描述（如"重视家庭聚会"而非"宗教家庭"）
3. 包含饮食、社交、决策风格
4. 语言简洁，适合作为用户画像标签

州列表：密西西比、纽约、加州、德州、犹他、佛罗里达...
（分批次查询，每次5个州）
```

**输出格式（Excel表格）：**
| 州名 | 家庭观念 | 饮食偏好 | 社交风格 | 生活节奏 | 决策风格 |
|------|---------|---------|---------|---------|---------|
| Mississippi | 非常重视 | 传统舒适食物 | 热情社区导向 | 慢节奏 | 重视传统 |
| New York | 中等 | 多元快餐 | 直接高效 | 快节奏 | 注重效率 |

#### 下午（13:00-18:00）
**任务 1.2：提取宗教关联的文化特性（隐性转换）**

**核心目标：** 将宗教特征转换为"文化行为描述"，避免宗教字眼

**转换示例表：**
| 宗教背景（内部使用，不输出） | 文化行为描述（给大模型看） |
|--------------------------|------------------------|
| 天主教为主的州 | "重视周末家庭时间，传统饮食习惯，社区活动活跃" |
| 犹太教社区 | "注重特定饮食规矩（避免某些食材），周五晚家庭聚会" |
| 摩门教州（犹他） | "不饮酒不吸烟，家庭价值观极强，生活规律" |
| 佛教影响地区 | "植物性饮食偏好，注重内心平静，冥想习惯" |

**操作方法：**
- 向AI提问："美国哪些州受天主教文化影响？这些地区居民有哪些共同生活习惯？请用非宗教语言描述。"
- 整理成"州名→文化描述"的对照表

**任务 1.3：构建最终映射表（50条数据）**

**格式：** 简单文本文件或Excel表格

**示例内容：**
```
密西西比州：
重视家庭聚会和社区关系，偏好传统舒适食物（如炖菜、烧烤），
社交风格热情，生活节奏慢，决策时重视周围人意见。

纽约州：
多元文化背景，快节奏生活，注重个人效率，
饮食多样化，社交直接，决策独立。

加州：
健康意识强，植物性饮食流行，注重环保和创新，
社交开放包容，生活节奏适中，追求个人成长。
```

**验收标准：**
- ✅ 覆盖至少20个高人口州（占北美80%人口）
- ✅ 每个州的描述控制在50字以内（便于拼接到提示词）
- ✅ 全文无任何宗教字眼（用"传统价值观"代替"宗教信仰"）

---

### Day 2：提示词模板设计与文化融入测试（2025-12-17）

#### 上午（9:00-12:00）
**任务 2.1：设计文化适配提示词模板**

**核心原理：** 在现有提示词基础上，动态插入用户的文化背景描述，让大模型自动调整回答风格。

**原有提示词结构（保持不变）：**
```
[系统角色] 你是五行决策顾问...
[知识库内容] L4匹配的五行知识...
[用户八字] 出生于1998年7月31日，八字为戊寅己未...
[对话历史] 用户之前问了什么...
[当前问题] 用户现在问："What should I wear today?"
```

**新增文化适配段落（插入到提示词末尾）：**
```
=== Cultural Context (Important) ===
This user is from [州名], where people typically:
- [文化特性1：如"value family gatherings and traditional meals"]
- [文化特性2：如"prefer community-oriented decisions"]
- [文化特性3：如"have a slower-paced lifestyle"]

Please adjust your Wu Xing advice to fit their cultural background:
1. Use examples relevant to their lifestyle
2. Consider their social norms (e.g., conservative vs. liberal)
3. NEVER mention any religious terms (e.g., "Christian", "Catholic", "Jewish")
4. Keep advice practical and culturally sensitive
===
```

**拼接规则：**
- 如果用户填写了出生州 → 查映射表 → 插入文化描述
- 如果用户未填写 → 不插入文化段落，使用通用回答

#### 下午（13:00-18:00）
**任务 2.2：测试5个典型文化场景**

**测试目标：** 验证提示词能否让大模型自动调整回答风格

**测试案例设计：**

| 案例 | 用户画像 | 测试问题 | 预期输出关键词 |
|------|---------|---------|---------------|
| **1. 保守南部用户** | 密西西比州，女性，30岁 | "What should I wear to a family gathering?" | beige/earth tones, modest, family-friendly |
| **2. 自由派都市用户** | 纽约州，男性，28岁 | "What should I wear to work?" | sharp/structured, black/white, professional |
| **3. 健康意识用户** | 加州，女性，25岁 | "What should I eat for lunch?" | plant-based, light, energy-focused |
| **4. 传统中西部用户** | 密歇根州，男性，45岁 | "Should I change my job?" | stability, family security, cautious |
| **5. 多元文化用户** | 纽约布鲁克林，女性，35岁 | "What should I cook for dinner?" | diverse flavors, no pork/shellfish, balanced |

**操作步骤：**
1. 在系统中输入用户信息（州名、性别、年龄）
2. 提问
3. 检查回答是否：
   - ✅ 包含文化相关描述（如"for family gatherings"）
   - ✅ 无任何宗教字眼
   - ✅ 五行逻辑依然正确（如土元素=稳定）
   - ✅ 语言自然，不生硬

**如果测试不通过：**
- 调整提示词的指令强度（如改为"【Critical】NEVER use..."）
- 增加负面案例（"Don't say: 'This aligns with Christian values'"）
- 调整文化描述的详细程度（太长可能被忽略，太短可能不明确）

**任务 2.3：完善映射表内容**

根据测试结果，补充映射表中缺失的州：
- 优先补充高人口州：加州、德州、佛罗里达、宾州、俄亥俄...
- 确保每个州的描述长度一致（约50字）
- 增加"决策风格"维度（如保守州强调"稳定优先"，自由派州强调"个人选择"）

---

### Day 3：系统集成与测试验证（2025-12-18）

#### 上午（9:00-12:00）
**任务 3.1：前端增加出生州输入框**

**改动点：** 在八字输入表单中增加"出生州"选择框（可选填写）

**用户体验设计：**
- 下拉菜单形式，列出常见州（前20个高人口州）
- 增加"Other"选项（低频州不单独列出）
- 位置放在"出生日期"和"出生时间"下方
- 灰色提示文字："Optional - Helps personalize advice"

**界面示例：**
```
🔮 命理信息（可选）
┌─────────────────────────────────┐
│ 出生日期：[选择日期]             │
│ 出生时间：[选择时间]             │
│ 出生州：  [下拉选择] ← 新增     │
│ 性别：    [男/女]               │
└─────────────────────────────────┘
```

**任务 3.2：后端集成文化映射逻辑**

**改动说明：** 让系统在生成回答时，自动查询映射表并拼接提示词

**工作流程：**
1. 用户提交问题 + 出生州
2. 系统查询映射表 → 获取该州的文化描述
3. 将文化描述插入提示词
4. 大模型根据提示词生成回答

**关键点：**
- 如果用户未填写出生州 → 跳过文化适配，使用通用回答
- 映射表采用静态文件（JSON/Excel），无需数据库改动
- 文化描述长度控制在100字以内（避免影响提示词效率）

#### 下午（13:00-18:00）
**任务 3.3：全流程测试验收（10个案例or/templates/advisor/index.html` - 新增出生地输入字段

---

## 五、风险控制措施

| 风险 | 应对措施 |
|------|---------|
| **宗教字眼泄露** | 在 Prompt 中明确禁止指令；输出内容二次过滤（正则检测"Christ", "Jesus"等） |
| **文化推断错误** | 提供"文化信息可能不准确"的免责声明；允许用户手动覆盖文化信息 |
| **数据量不足** | 先覆盖高频组合（南部+保守、东北+自由），低频组合用通用模板 |
| **模型不遵守指令** | 多轮测试，调整 Prompt 权重（如"【Critical】NEVER use..."） |

---

## 六、第一周后续迭代计划

### Week 1 交付目标
- ✅ 完成 Mississippi、New York、California、Texas、Utah 5个高人口州的文化适配
- ✅ 覆盖3个核心场景（穿搭、饮食、社交）
- ✅ 通过5个典型案例测试（无宗教字眼）

### Week 2-3 优化方向
- [ ] 扩展至50个州的完整映射
- [ ] 增加年龄段、种族的细化维度
- [ ] A/B测试：对比有无文化适配的用户满意度
- [ ] 数据分析：统计高频推断结果，优化映射表

---

## 七、成功标准

| 指标 | 目标 |
|------|------|
| **文化覆盖率** | 至少覆盖 North America 80%人口的州（前20个州） |
| **内容精准度** | 文化适配建议与用户画像匹配度 ≥ 85%（人工评估） |
| **宗教风险率** | 输出内容包含宗教字眼的概率 < 1%（正则检测） |
| **响应时间** | 文化推断耗时 < 100ms（不影响整体响应速度） |
| **用户反馈** | 内测用户认为建议"文化敏感且实用"的比例 ≥ 70% |

---

**验收标准（10个测试案例）：**

| 编号 | 用户画像 | 测试问题 | 验收要点 |
|------|---------|---------|---------|
| 1 | 密西西比州，女性，30岁 | "What should I wear to church?" | ✅ 建议保守得体（beige/earth tones）<br>❌ 不出现"church""Catholic"等字眼 |
| 2 | 纽约州，男性，28岁 | "What should I eat for a quick lunch?" | ✅ 建议快捷高效（salad/wrap）<br>✅ 体现快节奏文化 |
| 3 | 加州，女性，25岁 | "Should I try a plant-based diet?" | ✅ 建议健康饮食<br>❌ 不出现"Buddhist""vegan religion"等 |
| 4 | 德州，男性，40岁 | "What should I wear to a BBQ?" | ✅ 建议休闲舒适（牛仔风格）<br>✅ 体现南部文化 |
| 5 | 犹他州，女性，35岁 | "Should I have wine with dinner?" | ✅ 建议无酒精饮品<br>❌ 不出现"Mormon""LDS"等字眼 |
| 6 | 纽约布鲁克林，女性，32岁 | "What should I cook for Shabbat?" | ✅ 避免猪肉/贝类<br>❌ 不出现"Jewish""Kosher"等字眼 |
| 7 | 佛罗里达州，男性，50岁 | "Should I retire early?" | ✅ 建议考虑生活节奏<br>✅ 体现休闲文化 |
| 8 | 密歇根州，女性，28岁 | "Should I move to a big city?" | ✅ 建议权衡稳定性<br>✅ 体现中西部家庭观念 |
| 9 | 华盛顿州，男性，26岁 | "What career should I pursue?" | ✅ 建议科技创新方向<br>✅ 体现西海岸文化 |
| 10 | 未填写州，女性，30岁 | "What should I wear today?" | ✅ 使用通用五行建议<br>✅ 无文化偏向性 |

**测试方法：**
1. 逐个输入用户信息和问题
2. 复制系统回答到Word文档
3. 用"查找功能"搜索禁用词清单（见下方）
4. 检查回答是否自然融入文化特性

**禁用词清单（必须全文搜索）：**
```
Christian, Catholic, Protestant, Jewish, Mormon, LDS, Buddhist, 
Hindu, Muslim, Islam, Jesus, Christ, God, Church, Temple, 
Synagogue, Mosque, Bible, Torah, Quran, Prayer, Worship, 
Religious, Faith, Believer, Saint, Pope, Rabbi, Priest
```
