# V4 ç‰ˆæœ¬æŠ€æœ¯æ±‡æŠ¥ï¼šåŒ—ç¾å¸‚åœºæ–‡åŒ–é€‚é…

**æ—¥æœŸï¼š** 2025å¹´12æœˆ16æ—¥  
**ç‰ˆæœ¬ï¼š** V4.0  
**æ ¸å¿ƒåŠŸèƒ½ï¼š** é¢å‘åŒ—ç¾å¸‚åœºçš„æ–‡åŒ–é€‚é…ä¸ç”¨æˆ·èµ‹èƒ½ä½“éªŒå‡çº§

---

## ä¸€ã€ç‰ˆæœ¬è¿­ä»£èƒŒæ™¯

### 1.1 ç°çŠ¶åˆ†æ
**V3 ç‰ˆæœ¬é—®é¢˜ï¼š**
- å›ç­”é£æ ¼åå‘ä¸­å¼å‘½ç†æœ¯è¯­ï¼ˆå¦‚"å…«å­—"ã€"äº”è¡Œç”Ÿå…‹"ï¼‰
- ç¼ºä¹åœ°åŸŸæ–‡åŒ–é€‚é…ï¼ŒåŒ—ç¾ç”¨æˆ·éš¾ä»¥äº§ç”Ÿå…±é¸£
- å›ç­”åå‘"å’¨è¯¢å¼"è€Œé"èµ‹èƒ½å¼"ï¼Œç”¨æˆ·è¢«åŠ¨æ¥å—å»ºè®®

### 1.2 æ”¹è¿›ç›®æ ‡
å®ç°**åŒ—ç¾å¸‚åœºæ–‡åŒ–é€‚é…ä¸ç”¨æˆ·èµ‹èƒ½ä½“éªŒ**ï¼š
- éšè—å‘½ç†æœ¯è¯­ â†’ ç”¨æˆ·æ„ŸçŸ¥ä¸º"ä¸ªäººæˆé•¿æŒ‡å¯¼"
- 50å·æ–‡åŒ–æ˜ å°„ â†’ å»ºè®®èå…¥åœ°åŸŸç”Ÿæ´»æ–¹å¼
- èµ‹èƒ½å¼å›ç­” â†’ è®©ç”¨æˆ·æ„Ÿè§‰"å˜å¾—æ›´å¼º"è€Œé"è¢«å‘ŠçŸ¥å‘½è¿"

### 1.3 æ ¸å¿ƒç†å¿µ
> **å¤–å›½ç”¨æˆ·è¿½æ±‚çš„æ˜¯ï¼šç”¨äº†æˆ‘ä»¬çš„å»ºè®®å¯ä»¥è®©è‡ªå·±å˜å¾—æ›´å¼ºï¼Œæˆä¸ºä¸€ä¸ªæ›´å¥½çš„äººã€‚**

---

## äºŒã€V4 æŠ€æœ¯æ–¹æ¡ˆ

### 2.1 æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ç”¨æˆ·å‰ç«¯                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ æ–°å¢ï¼šå·é€‰æ‹©ä¸‹æ‹‰æ¡†                                â”‚      â”‚
â”‚  â”‚ - 50ä¸ªç¾å›½å·é€‰é¡¹                                  â”‚      â”‚
â”‚  â”‚ - ç”¨äºæ–‡åŒ–é€‚é…                                    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚ POST /advisor/ask/
                      â”‚ query + bazi_data + user_state
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Django åç«¯                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ æ–°å¢ï¼šcultural_mapping.json                       â”‚      â”‚
â”‚  â”‚ - 50å·æ–‡åŒ–ç‰¹å¾æ˜ å°„                                â”‚      â”‚
â”‚  â”‚ - åŒ…å«ç©¿æ­/é¥®é£Ÿ/ç”Ÿæ´»æ–¹å¼å»ºè®®æ–¹å‘                 â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ views.py æ”¹åŠ¨                                     â”‚      â”‚
â”‚  â”‚ â”œâ”€ load_cultural_mapping() - åŠ è½½æ–‡åŒ–æ˜ å°„        â”‚      â”‚
â”‚  â”‚ â”œâ”€ get_cultural_context() - è·å–å·æ–‡åŒ–ä¸Šä¸‹æ–‡     â”‚      â”‚
â”‚  â”‚ â”œâ”€ ä¼˜åŒ– MCP è°ƒç”¨é€»è¾‘ - é¿å…é‡å¤è¯·æ±‚              â”‚      â”‚
â”‚  â”‚ â””â”€ éšæ€§æç¤º - ä¸æš´éœ²å…«å­—/åœ°åŸŸæ¥æº                â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Prompt Engineering V4                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ ç³»ç»Ÿè§’è‰²å‡çº§                                      â”‚      â”‚
â”‚  â”‚ â”œâ”€ "Personal Growth Advisor"ï¼ˆä¸ªäººæˆé•¿é¡¾é—®ï¼‰     â”‚      â”‚
â”‚  â”‚ â”œâ”€ èµ‹èƒ½å¼è¯­æ°”ï¼ˆ"Do this" è€Œé "You could try"ï¼‰ â”‚      â”‚
â”‚  â”‚ â”œâ”€ éšè—äº”è¡Œæœ¯è¯­ â†’ è‡ªç„¶è¯­è¨€æè¿°                   â”‚      â”‚
â”‚  â”‚ â””â”€ æ¯æ¡å»ºè®®éƒ½è®©ç”¨æˆ·æ„Ÿè§‰æ›´å¼ºå¤§                    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚ éšæ€§ä¸Šä¸‹æ–‡æ³¨å…¥                                    â”‚      â”‚
â”‚  â”‚ â”œâ”€ å…«å­—ä¿¡æ¯ â†’ "FOR YOUR REFERENCE ONLY"          â”‚      â”‚
â”‚  â”‚ â”œâ”€ åœ°åŸŸæ–‡åŒ– â†’ "FOR YOUR REFERENCE ONLY"          â”‚      â”‚
â”‚  â”‚ â””â”€ æŒ‡ä»¤ï¼šä¸è¦åœ¨å›ç­”ä¸­æåŠæ¥æº                    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€æ ¸å¿ƒæŠ€æœ¯å®ç°

### 3.1 æ–°å»ºæ–‡ä»¶ï¼š`cultural_mapping.json`

**åŠŸèƒ½ï¼š** 50å·æ–‡åŒ–ç‰¹å¾æ˜ å°„è¡¨

**æ•°æ®ç»“æ„ç¤ºä¾‹ï¼š**
```json
{
  "California": {
    "region": "West Coast",
    "cultural_traits": "Tech-forward, health-conscious, diverse and multicultural, outdoor lifestyle, creative and entrepreneurial spirit",
    "fashion_notes": "Casual chic, athleisure popular, sustainable fashion valued, tech company casual dress codes common",
    "food_culture": "Farm-to-table, fusion cuisine, health food trends, diverse ethnic foods, wine culture in Napa region",
    "lifestyle": "Active outdoor lifestyle, wellness culture, work-life balance emphasized in some areas, traffic-heavy commutes in cities"
  },
  "Texas": {
    "region": "South/Southwest",
    "cultural_traits": "Strong state pride, independent spirit, friendly and hospitable, traditional values mixed with urban progressiveness",
    "fashion_notes": "Western wear influences, boots and denim popular, business casual in cities, practical for heat",
    "food_culture": "BBQ culture, Tex-Mex cuisine, steakhouses, craft beer scene growing, comfort food traditions",
    "lifestyle": "Car-dependent, suburban lifestyle common, strong community ties, outdoor activities like hunting and fishing"
  },
  "New York": {
    "region": "Northeast",
    "cultural_traits": "Fast-paced, ambitious, culturally diverse, arts and finance hub, direct communication style",
    "fashion_notes": "Fashion-forward, black clothing popular, professional dress important, seasonal dressing",
    "food_culture": "World-class dining, diverse ethnic neighborhoods, pizza and bagel culture, food delivery culture",
    "lifestyle": "Public transit oriented, walking culture, small living spaces, vibrant nightlife, work-centric"
  }
  // ... å…±50ä¸ªå·
}
```

**è¦†ç›–èŒƒå›´ï¼š**
- å…¨éƒ¨50ä¸ªç¾å›½å·
- æ¯å·åŒ…å«ï¼šåœ°åŒºã€æ–‡åŒ–ç‰¹å¾ã€ç©¿æ­é£æ ¼ã€é¥®é£Ÿæ–‡åŒ–ã€ç”Ÿæ´»æ–¹å¼

---

### 3.2 ä¿®æ”¹å‰ç«¯ï¼š`index.html`

**æ–°å¢ï¼š50å·é€‰æ‹©ä¸‹æ‹‰æ¡†**

```html
<div class="state-selector">
    <label for="user-state">ğŸ“ Your State (Optional):</label>
    <select id="user-state" name="user_state">
        <option value="">-- Select State --</option>
        <option value="Alabama">Alabama</option>
        <option value="Alaska">Alaska</option>
        <option value="Arizona">Arizona</option>
        <!-- ... å…¨éƒ¨50å· ... -->
        <option value="Wyoming">Wyoming</option>
    </select>
</div>
```

**JavaScript æ”¹åŠ¨ï¼š**
```javascript
// æ”¶é›†ç”¨æˆ·å·ä¿¡æ¯
const userState = document.getElementById('user-state').value;
if (userState) {
    formData.append('user_state', userState);
}
```

---

### 3.3 ä¿®æ”¹åç«¯ï¼š`views.py`

#### æ”¹åŠ¨ 1ï¼šæ–‡åŒ–æ˜ å°„åŠ è½½å‡½æ•°
```python
def load_cultural_mapping():
    """åŠ è½½åŒ—ç¾50å·æ–‡åŒ–æ˜ å°„"""
    mapping_path = os.path.join(os.path.dirname(__file__), 'cultural_mapping.json')
    try:
        with open(mapping_path, 'r', encoding='utf-8') as f:
            return json.load(f)
    except FileNotFoundError:
        return {}

def get_cultural_context(user_state):
    """è·å–ç”¨æˆ·æ‰€åœ¨å·çš„æ–‡åŒ–ä¸Šä¸‹æ–‡"""
    if not user_state:
        return ""
    
    cultural_mapping = load_cultural_mapping()
    state_info = cultural_mapping.get(user_state, {})
    
    if not state_info:
        return ""
    
    return f"""
Cultural Context for {user_state}:
- Region: {state_info.get('region', 'N/A')}
- Cultural Traits: {state_info.get('cultural_traits', 'N/A')}
- Fashion Notes: {state_info.get('fashion_notes', 'N/A')}
- Food Culture: {state_info.get('food_culture', 'N/A')}
- Lifestyle: {state_info.get('lifestyle', 'N/A')}
"""
```

#### æ”¹åŠ¨ 2ï¼šæ¥æ”¶ç”¨æˆ·å·å‚æ•°
```python
def ask_advisor(request):
    user_query = request.POST.get('query', '').strip()
    session_id = request.POST.get('session_id', '').strip()
    bazi_data_json = request.POST.get('bazi_data', '')
    
    # æ–°å¢ï¼šæ¥æ”¶ç”¨æˆ·å·ä¿¡æ¯
    user_state = request.POST.get('user_state', '').strip()
    
    return StreamingHttpResponse(
        generate_stream_response(user_query, session_id, bazi_data, user_state)
    )
```

#### æ”¹åŠ¨ 3ï¼šä¼˜åŒ– MCP è°ƒç”¨é€»è¾‘
```python
def generate_stream_response(user_query, session_id, bazi_data=None, user_state=None):
    # ä¼˜åŒ–ï¼šåªåœ¨ session ä¸­æ²¡æœ‰ bazi_text æ—¶æ‰è°ƒç”¨ MCP
    bazi_text = session.get('bazi_text', '')
    
    if not bazi_text and bazi_data:  # å…³é”®ä¼˜åŒ–ç‚¹
        try:
            bazi_result = call_bazi_mcp(
                bazi_data.get('solar_datetime'),
                bazi_data.get('gender', 1)
            )
            bazi_text = format_bazi_for_llm(bazi_result)
            session['bazi_text'] = bazi_text  # ç¼“å­˜åˆ° session
        except Exception as e:
            bazi_text = ""
```

#### æ”¹åŠ¨ 4ï¼šéšæ€§æç¤ºè®¾è®¡ï¼ˆæ ¸å¿ƒï¼‰
```python
# å…«å­—ä¿¡æ¯ - ä»…ä¾›å‚è€ƒï¼Œä¸è¦åœ¨å›ç­”ä¸­æåŠ
bazi_context = f"""
=== User's Bazi (Birth Chart) - FOR YOUR REFERENCE ONLY ===
{bazi_text}

IMPORTANT: Use this Bazi information as BACKGROUND CONTEXT to inform your advice, but:
- DO NOT mention specific Bazi terms like "å·±äº¥", "ç”²æœ¨", "å¤§è¿" etc. in your response
- DO NOT say "based on your Bazi" or "your birth chart shows"
- Instead, say things like "based on your natural tendencies" or "given your strengths"
- The user should feel you understand them deeply, without knowing HOW you know
===
"""

# åœ°åŸŸæ–‡åŒ– - ä»…ä¾›å‚è€ƒï¼Œä¸è¦åœ¨å›ç­”ä¸­æåŠ
cultural_context = f"""
=== Cultural Context - FOR YOUR REFERENCE ONLY ===
{get_cultural_context(user_state)}

IMPORTANT: Use this cultural information to make your advice RELEVANT and PRACTICAL, but:
- DO NOT explicitly mention the state name or say "since you're in Kentucky"
- DO NOT say "based on your location" or "in your area"
- Instead, naturally incorporate culturally appropriate suggestions
- The advice should feel personally tailored without revealing the data source
===
"""
```

---

### 3.4 Prompt æ”¹é€ ï¼šèµ‹èƒ½å¼è¯­æ°”

#### æ—§ç‰ˆï¼ˆV3 å’¨è¯¢å¼ï¼‰
```
You are a Wu Xing (Five Elements) advisor...
You could consider wearing earth tones...
Based on your Bazi, water element is weak...
```

#### æ–°ç‰ˆï¼ˆV4 èµ‹èƒ½å¼ï¼‰
```python
system_role = """You are a Wu Xing (Five Elements) personal growth advisor 
who empowers users to become their strongest, best selves.

Core Mission:
Every piece of advice you give should help the user GROW STRONGER, 
make BETTER DECISIONS, and become a MORE CAPABLE person.

Five Elements Principles (use the CONCEPTS, not the labels):
- Wood: Growth, boldness, forward motion 
  - describe as "moving forward", "taking initiative", "expanding your potential"
- Fire: Passion, visibility, expression 
  - describe as "stepping into your power", "being magnetic", "expressing your authentic self"
- Earth: Stability, grounding, centering 
  - describe as "building your foundation", "staying grounded", "cultivating inner strength"
- Metal: Clarity, structure, boundaries 
  - describe as "sharpening your focus", "setting clear boundaries", "making decisive moves"
- Water: Flow, adaptability, intuition 
  - describe as "trusting your instincts", "adapting with wisdom", "flowing through challenges"

Style rules:
- Say "Do this" NOT "You could try..." - be confident and empowering
- DON'T say "water energy" or "earth energy" 
  - say "you're building strength" or "you're developing clarity"
- Be like a wise coach who believes in their potential
- Every answer should leave them feeling MORE capable, not dependent

Example:
"Wear beige or brown. Right now you're scattered - these grounded tones 
will help you center your power. Add one gold piece for sharp focus. 
You're not trying to impress anyone; you're showing up as someone 
who knows their own strength."
"""
```

---

## å››ã€æ•ˆæœå¯¹æ¯”

### 4.1 å›ç­”é£æ ¼å¯¹æ¯”

| ç»´åº¦ | V3ï¼ˆåŸç‰ˆï¼‰ | V4ï¼ˆåŒ—ç¾é€‚é…ï¼‰ |
|------|-----------|---------------|
| **è¯­æ°”** | "æ‚¨å¯ä»¥è€ƒè™‘..." | "Do this." |
| **æœ¯è¯­** | "æ ¹æ®æ‚¨çš„å…«å­—ï¼Œæ°´å…ƒç´ åå¼±" | "Right now you need more flow and adaptability" |
| **åœ°åŸŸ** | æ— åœ°åŸŸé€‚é… | éšæ€§èå…¥å½“åœ°ç”Ÿæ´»æ–¹å¼ |
| **æ„Ÿå—** | è¢«åŠ¨æ¥å—å»ºè®® | æ„Ÿè§‰è‡ªå·±åœ¨å˜å¼º |
| **æ¥æº** | æ˜¾æ€§æåŠå…«å­—/äº”è¡Œ | éšæ€§è¿ç”¨ï¼Œä¸æš´éœ²æ¥æº |

### 4.2 ç¤ºä¾‹å¯¹è¯

**ç”¨æˆ·æé—®ï¼š** "What should I wear to an important meeting tomorrow?"  
**ç”¨æˆ·å·ï¼š** Kentucky  
**ç”¨æˆ·å…«å­—ï¼š** å·±äº¥å¹´ ç”²æˆŒæœˆ...

**V3 å›ç­”ï¼ˆæ—§ï¼‰ï¼š**
> Based on your Bazi chart showing weak water element, you could consider wearing darker blue tones to balance your five elements. Since you're in Kentucky, perhaps...

**V4 å›ç­”ï¼ˆæ–°ï¼‰ï¼š**
> Go with navy blue or deep charcoal. Right now you need grounding - these colors project quiet authority without trying too hard. Skip the tie if you can; keep it clean and unfussy. One silver watch or cuff, nothing more. You're walking in there like someone who already has the answer. That's your edge.

---

## äº”ã€æ–‡ä»¶æ”¹åŠ¨æ¸…å•

| æ–‡ä»¶ | æ”¹åŠ¨ç±»å‹ | è¯´æ˜ |
|------|---------|------|
| `advisor/cultural_mapping.json` | æ–°å¢ | 50å·æ–‡åŒ–æ˜ å°„æ•°æ® |
| `advisor/templates/advisor/index.html` | ä¿®æ”¹ | æ·»åŠ å·é€‰æ‹©ä¸‹æ‹‰æ¡† |
| `advisor/views.py` | ä¿®æ”¹ | æ–‡åŒ–æ˜ å°„åŠ è½½ã€éšæ€§æç¤ºã€MCPä¼˜åŒ– |

---

## å…­ã€æŠ€æœ¯äº®ç‚¹

### 6.1 éšæ€§æç¤ºè®¾è®¡
- **é—®é¢˜ï¼š** ç”¨æˆ·ä¸å¸Œæœ›çœ‹åˆ°"æ ¹æ®ä½ çš„å…«å­—"æˆ–"å› ä¸ºä½ åœ¨è‚¯å¡”åŸºå·"
- **æ–¹æ¡ˆï¼š** åœ¨ Prompt ä¸­æ˜ç¡®æ ‡æ³¨ `FOR YOUR REFERENCE ONLY`ï¼Œå¹¶æ·»åŠ æŒ‡ä»¤ç¦æ­¢æš´éœ²æ¥æº
- **æ•ˆæœï¼š** å»ºè®®æ„Ÿè§‰"é‡èº«å®šåˆ¶"ï¼Œä½†ç”¨æˆ·ä¸çŸ¥é“æ•°æ®æ¥æº

### 6.2 MCP è°ƒç”¨ä¼˜åŒ–
- **é—®é¢˜ï¼š** æ¯æ¬¡å¯¹è¯éƒ½è°ƒç”¨ MCPï¼Œæµªè´¹èµ„æº
- **æ–¹æ¡ˆï¼š** æ£€æŸ¥ session ä¸­æ˜¯å¦å·²æœ‰ `bazi_text`ï¼Œæœ‰åˆ™è·³è¿‡ MCP è°ƒç”¨
- **æ•ˆæœï¼š** å¤šè½®å¯¹è¯ä¸­ MCP åªè°ƒç”¨ä¸€æ¬¡

### 6.3 èµ‹èƒ½å¼è¯­æ°”è®¾è®¡
- **é—®é¢˜ï¼š** åŸç‰ˆè¯­æ°”åè½¯ï¼ŒåŒ—ç¾ç”¨æˆ·æœŸæœ›"æ•™ç»ƒå¼"æŒ‡å¯¼
- **æ–¹æ¡ˆï¼š** Prompt ä¸­æ˜ç¡®è¦æ±‚"Say 'Do this' NOT 'You could try...'"
- **æ•ˆæœï¼š** å›ç­”æ›´æœ‰åŠ›é‡æ„Ÿï¼Œç”¨æˆ·æ„Ÿè§‰è¢«èµ‹èƒ½

---

## ä¸ƒã€åç»­ä¼˜åŒ–æ–¹å‘

1. **æ›´å¤šåœ°åŒºæ”¯æŒï¼š** åŠ æ‹¿å¤§çœä»½ã€æ¬§æ´²å›½å®¶æ–‡åŒ–æ˜ å°„
2. **åŠ¨æ€æ–‡åŒ–æ›´æ–°ï¼š** æ ¹æ®å­£èŠ‚/èŠ‚æ—¥è°ƒæ•´æ–‡åŒ–å»ºè®®
3. **A/B æµ‹è¯•ï¼š** å¯¹æ¯”èµ‹èƒ½å¼ vs å’¨è¯¢å¼çš„ç”¨æˆ·ç•™å­˜ç‡
4. **å¤šè¯­è¨€æ”¯æŒï¼š** è¥¿ç­ç‰™è¯­ã€æ³•è¯­ç‰ˆæœ¬

---

## å…«ã€æ€»ç»“

V4 ç‰ˆæœ¬å®Œæˆäº†é¢å‘åŒ—ç¾å¸‚åœºçš„æ ¸å¿ƒé€‚é…ï¼š

| ç›®æ ‡ | å®ç°æ–¹å¼ | çŠ¶æ€ |
|------|---------|------|
| éšè—å‘½ç†æœ¯è¯­ | éšæ€§æç¤º + Prompt æ”¹é€  | âœ… å®Œæˆ |
| 50å·æ–‡åŒ–é€‚é… | cultural_mapping.json + åŠ¨æ€æ³¨å…¥ | âœ… å®Œæˆ |
| èµ‹èƒ½å¼ä½“éªŒ | ç³»ç»Ÿè§’è‰²é‡æ–°è®¾è®¡ | âœ… å®Œæˆ |
| MCP è°ƒç”¨ä¼˜åŒ– | Session ç¼“å­˜æœºåˆ¶ | âœ… å®Œæˆ |

**æ ¸å¿ƒä»·å€¼ï¼š** è®©åŒ—ç¾ç”¨æˆ·æ„Ÿå—åˆ°"è¿™ä¸ª App çœŸçš„æ‡‚æˆ‘ï¼Œè€Œä¸”è®©æˆ‘å˜å¾—æ›´å¼º"ã€‚
